
<html>
<head>
    <meta charset="UTF-8"/>
    <title>User profile</title>

    <link type="text/css" href="../resources/css/flick/jquery-ui-1.8.18.custom.css" rel="stylesheet"/>
    <link type="text/css" href="../resources/css/style.css" rel="stylesheet"/>
    <link href="../resources/css/fileuploader.css" rel="stylesheet" type="text/css"/>

    <script type="text/javascript" src="../resources/js/jquery-1.7.1.min.js"></script>
    <script type="text/javascript" src="../resources/js/jquery-ui-1.8.18.custom.min.js"></script>
    <script src="../resources/js/fileuploader.js" type="text/javascript"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            hideSettingsValues();

            $("#profile_btn").click(function () {
                hideSettingsValues();
                $.getJSON("/Settings/Profile", function (data) {
                    $("#name").val(data.name);
                    $("#age").val(data.age);
                    $("#skype").val(data.skype);
                    $("#hobby").val(data.hobby);
                });

                $("#profile_settings").show();
            });

            $("#avatar_btn").click(function () {
                hideSettingsValues();
            });

            $('#profile_submit').click(function () {
                $.post("/Settings/Profile", $('#profile_form').serialize(), 'json');
            });

            var uploader = new qq.FileUploader({
                // pass the dom node (ex. $(selector)[0] for jQuery users)
                element: document.getElementById('upload_container'),
                // path to server-side upload script
                action: '/Settings/Profile/avatar',
                onComplete: updateImage
            });

            updateImage();

        });

        function hideSettingsValues() {
            $("#profile_settings").hide();
        }


    </script>


    <script type="text/javascript">
        $(function () {
            $("a, button").button();
        });

        var updateImage =  function  (){
            var src = "/Settings/Profile/avatar?" + new Date().getTime();
            $('#avatar').attr("src", src);
            $('#upload_container').innerHTML = "";
        }

    </script>

</head>
<body>


<div id="header" class="header">

    <div class="logout_btn">
        <a href="<c:url value=" j_spring_security_logout"/>">Logout</a>
    </div>
</div>



<div class="container">

    <div id="settings_navigation" class="navigation_vertical">
        <div>
            <a id="profile_btn" style="width:200px; margin: 5px;">Profile</a>
        </div>

        <div>
            <a id="avatar_btn" style="width:200px;margin: 5px" href="/upload">Upload file</a>
        </div>
    </div>


    <div id="settings_values" style=" width: 300px; margin: 0 auto; ">
        <div id="profile_settings">

            <form id="profile_form">
                <table>
                    <tr>
                        <td>
                            Name:
                        </td>
                        <td>
                            <input type="text" name="name" id="name" size="30" value=""/>
                        </td>
                    </tr>

                    <tr>
                        <td>
                            Age:
                        </td>
                        <td>
                            <input type="text" name="age" id="age" size="30" value=""/>
                        </td>
                    </tr>

                    <tr>
                        <td>
                            Skype:
                        </td>
                        <td>
                            <input type="text" name="skype" id="skype" size="30" value=""/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Hobby:
                        </td>
                        <td>
                            <input type="text" name="hobby" id="hobby" size="30" value=""/>
                        </td>

                    </tr>
                    <tr>
                        <td>
                            Avatar:
                        </td>
                        <td>
                            <img id="avatar" src="" width="150" height="150"/>
                        </td>
                    </tr>

                    <tr>
                        <td>

                        </td>
                        <td>
                            <div id="upload_container">

                            </div>
                        </td>
                    </tr>

                    <tr>
                        <td colspan="2" align="center">
                            <br/>
                            <button id="profile_submit" type="button" style="width: 250px">Save</button>

                        </td>
                    </tr>
                </table>
            </form>
        </div>

    </div>

</div>

<div id="footer" class="footer">2012</div>

<!-- End demo -->


</body>
</html>